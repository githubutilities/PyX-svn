\chapter{Module path: PostScript like paths}

\label{path}

With help of the path module, one is able to construct PostScript like 
paths, which are one of the main building blocks for the generation of 
drawings. To that end it provides 
\begin{itemize}
\item classes (derived from \verb|pathel|) for the primitives \verb|moveto|, \verb|lineto|, etc.
\item the class \verb|path| (and derivatives thereof) representing an
  entire PostScript path
\item the class \verb|normpath| (and derivatives thereof) which is a
  path consisting only of a certain subset of \verb|pathel|s, namely 
  \verb|moveto|, \verb|lineto|, \verb|curveto| and \verb|closepath|.
\end{itemize}

\section{Class pathel}

The class \verb|pathel| is the superclass of all PostScript path
construction primitives. It is never used directly, but only by
instantiating its subclasses, which correspond one by one to the
PostScript primitives.

\medskip
\begin{tabularx}{\linewidth}{>{\hsize=.7\hsize}X>{\raggedright\arraybackslash\hsize=1.3\hsize}X}
Subclass of \texttt{pathel} & Function \\
\hline
\texttt{closepath()} & closes current subpath \\
\texttt{moveto(x, y)} & sets current point to (\texttt{x},
\texttt{y})\\
\texttt{rmoveto(dx, dy)} & moves current point relative by (\texttt{dx},
\texttt{dy})\\
\texttt{lineto(x, y)} & appends straight line from current point to
(\texttt{x}, \texttt{y})\\
\texttt{rlineto(dx, dy)} & appends straight line from current point
relative by (\texttt{dx}, \texttt{dy})\\
\texttt{arc(x, y, r, \newline\phantom{arc(}angle1, angle2)} & appends arc segment in
counterclockwise direction with center (\verb|x|, \verb|y|) and
radius~\verb|r| from \verb|angle1| to \verb|angle2| (in degrees).\\
\texttt{arcn(x, y, r, \newline\phantom{arcn(}angle1, angle2)} & appends arc segment in
clockwise direction with center (\verb|x|, \verb|y|) and
radius~\verb|r| from \verb|angle1| to \verb|angle2| (in degrees). \\
\texttt{arct(x1, y1, x2, y2, r)} & appends arc segment with radius \verb|r|
which connects between (\verb|x1|, \verb|y1|) and (\verb|x2|,
\verb|y2|).\\
\texttt{rcurveto(dx1, dy1, \newline\phantom{rcurveto(}dx2, dy2,\newline\phantom{rcurveto(}dx3, dy3)} & appends a B\'ezier curve with
the control points current point, and the points defined relative to
the current point by (\verb|dx1|, \verb|dy1|), 
(\verb|dx2|, \verb|dy2|), and (\verb|dx3|, \verb|dy3|)
\end{tabularx}
\medskip

Some notes on the above:
\begin{itemize}
\item All coordinates are in \PyX\ lengths
\item If the current point is defined before an \verb|arc| or
  \verb|arcn| command, a straight line from current point to the
  beginning of the arc is prepended.
\item The bounding box (see below) of B\'ezier curves is actually only
  the control box, \textit{i.e.}\ not neccesarily the smallest
  enclosing rectangle.
\end{itemize}


\section{Class path}

The class path represents PostScript like paths in \PyX. The \verb|path| constructor allows the 
creation of such a path out of series of \verb|pathel|s. A simple example, which generates a triangle,
looks like:
\begin{quote}
\begin{verbatim}
from pyx import *
from path import *

p = path(moveto(0, 0), 
         lineto(0, 1),
         lineto(1, 1),
         closepath())
\end{verbatim}
\end{quote}
Later on, we shall see, how it is possible to output such a path on a
canvas. For the moment, we only want to discuss the methods provided
by the \verb|path| class. This range from standard operation like the
determination of the length of a path via \verb|len(p)|, fetching of
items using \verb|p[index]| and the possibility to concatenate two
paths, \verb|p1 + p2|, append further \verb|pathel|s using
\verb|p.append(pathel)| to more advanced methods, which are summarized
in the following table.

\medskip
\begin{tabularx}{\linewidth}{>{\hsize=.7\hsize}X>{\raggedright\arraybackslash\hsize=1.3\hsize}X}
  \texttt{path} method & Function \\
  \hline 
  \texttt{\_\_init\_\_(*pathels)} & construct new \texttt{path}
  consisting of \texttt{pathels}\\
  \texttt{append(pathel)} & appends \texttt{pathel} to end of \texttt{path}\\
  \texttt{arclength(epsilon=1e-5)} & returns the total arc length of all \texttt{path} segments in
  PostScript points with accuracy \texttt{epsilon}.\\
  \texttt{bbox()} & returns the bounding box of the \texttt{path}\\
  \texttt{reversed()} & returns the normalized reversed \texttt{path}.\\
  \texttt{transformed(trafo)} & returns the normalized and accordingly
  to the linear transformation \texttt{trafo} transformed path. Here,
  \texttt{trafo} must be an   instance of the \texttt{trafo.trafo} class.
\end{tabularx}
\medskip

Some notes on the above:
\begin{itemize}
\item The bounding box may be too large, if the path contains any
  \texttt{curveto} elements, since for these the control box,
  \textit{i.e.}, the bounding box enclosing the control points of
  the B\'ezier curve is returned.
\end{itemize}

\section{Class normpath}

The \texttt{normpath} class represents a specialized form of a
\texttt{path}, which only contains the elements \verb|moveto|,
\verb|lineto|, \verb|curveto| and \verb|closepath|. Any path can
easily be converted to its normalized form by passing it as parameter
to the \texttt{normpath} constructor:
\begin{quote}
\begin{verbatim}
np = normpath(p)
\end{verbatim}
\end{quote}
By passing a series of \texttt{pathel}s to the constructor, a
\texttt{normpath} can be constructed like a generic \texttt{path}.
Besides the \texttt{path} methods, \texttt{normpath} provides more 
advanced features like splitting (via \texttt{normpath.split(t)}),
intersection (via \texttt{normpath.intersect(other))}, etc.
More details are given in the next table:

\begin{tabularx}{\linewidth}{>{\hsize=.7\hsize}X>{\raggedright\arraybackslash\hsize=1.3\hsize}X}
  \texttt{normpath} method & Function \\
  \hline 
  \texttt{append(pathel)} & appends \texttt{pathel} to end of
  \texttt{normpath} and ``renormalizes'' it.\\
  \texttt{at(t)} & returns the coordinates of the point of
  \texttt{normpath} corresponding to the parameter value \texttt{t}.\\
  \texttt{intersect(onormpath, \newline\phantom{intersect(}epsilon=1e-5)} &
  returns a list of parameter values (as tuples \texttt{(tself, tother)}) corresponding to the 
  intersection points of \texttt{normpath} and \texttt{onormpath}.\\
  \texttt{split(t)} & returns a tuple consisting of two
  \texttt{normpath}s corresponding to the \texttt{normpath} split at
  the parameter value \texttt{t}.
\end{tabularx}



\section{Subclasses of path}

For your convenience, some special PostScript paths are already defined, which
are given in the following table.

\medskip
\begin{tabularx}{\linewidth}{l>{\raggedright\arraybackslash}X}
Subclass of \texttt{path} & Function \\
\hline
\texttt{line(x1, y1, x2, y2)} & a line from the point
  (\texttt{x1}, \texttt{y1}) to the point (\texttt{x2}, \texttt{y2})\\
\texttt{curve(x0, y0, x1, y1, x2, y2, x3, y3)} & a B\'ezier curve with 
control points  (\texttt{x0}, \texttt{y0}), $\dots$, (\texttt{x3}, \texttt{y3}).\\
\texttt{rect(x, y, w, h)} &  a rectangle with the
  lower left point (\texttt{x}, \texttt{y}), width~\texttt{w}, and
  height~\texttt{h}. \\
\texttt{circle(x, y, r)} & a circle with 
  center (\texttt{x}, \texttt{y}) and radius~\texttt{r}.
\end{tabularx}
\medskip


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "manual.tex"
%%% End:
